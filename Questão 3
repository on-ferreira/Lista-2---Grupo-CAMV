#include <stdio.h>
#include <stdlib.h>
#include <locale.h>
#include <math.h>
#include <string.h>
#include <conio.h> 
#include <unistd.h>

int JdV[3][3],DIM; //inicializada no int main
int checarinput(int aux1, int aux2); //feito
void checarlinha(); // feito
void checarcoluna(); // feito
void checardiagonal_principal(); // feito
void checardiagonal_secundaria(); // feito
void empate(); //feito
void rodada(int numero_jogador); //feito
void tabuleiro(); //feito
void menu();
int numero_jogador;
int main() 
{
	system("color 1F");
	setlocale (LC_ALL, "");
	menu();
	int JdV[][DIM] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};  /* matrix que recebera o jogo da velha no formato padrão 
3x3, note que a matriz já está sendo inicializada*/
	system("cls");
	return 0;
}

void empate()
{
	int ctEmpate=0,linha,coluna;
	for(linha =0; linha<DIM; linha++)
	{
		for(coluna = 0; coluna<DIM; coluna++)
		{
			if(JdV[linha][coluna]!=0)
			{
				ctEmpate++;
			}
		}
	}
	if((linha*coluna) == ctEmpate) 
	{
		printf("Empate!");
		exit(0);
	}
}

void tabuleiro()
{
	printf("\nTabuleiro:\n");
	for(int linha = 0; linha<DIM;linha++)
		{
		for(int coluna=0; coluna<DIM;coluna++)
			{
				printf("%d ", JdV[linha][coluna]);
			}
			printf("\n");
		}
	checarlinha();
	checarcoluna();
	checardiagonal_principal();
	checardiagonal_secundaria();
	empate();
	int numero_jogador;
	if(numero_jogador==1) numero_jogador== 2;
	if(numero_jogador==2) numero_jogador== 1;
}

void rodada(int numero_jogador)
{
	int aux1, aux2;
	if(numero_jogador== 1)
	{
		printf("\nPrimeiro Jogador:");
	}
	
	if(numero_jogador == 2)
	{
		printf("\nSegundo Jogador:");
	}
	scanf("%d %d",&aux1, &aux2);
	if(checarinput(aux1,aux2) == 1)
	{
		printf("\nPosição Inválida!\nTente novamente!");
		rodada(numero_jogador);
	}
	else tabuleiro();
}

int checarinput(int aux1, int aux2)
{
	if (JdV[aux1-1][aux2-1]==0) return 0;
	else return 1;
}

void checarlinha()
{
	if(numero_jogador ==1)
	{
		for(int linha =0; linha<DIM; linha++)
			{
				if( JdV[linha][0] == 1 && JdV[linha][1] ==1 && JdV[linha][2]==1)
				{
					printf("Parabéns! Primeiro jogador ganhou!");
					exit(0);
				}
			}
	}
	
	if(numero_jogador ==2)
	{
		for(int linha =0; linha<DIM; linha++)
			{
				if( JdV[linha][0] == 2 && JdV[linha][1] ==2 && JdV[linha][2]==2)
				{
					printf("Parabéns! Segundo jogador ganhou!");
					exit(0);
				}
			}
	}
}

void checarcoluna()
{
	if(numero_jogador ==1)
	{
		for(int coluna =0; coluna<DIM; coluna++)
			{
				if( JdV[0][coluna] == 1 && JdV[1][coluna] ==1 && JdV[1][coluna]==1)
				{
					printf("Parabéns! Primeiro jogador ganhou!");
					exit(0);
				}
			}
	}
	
	if(numero_jogador ==2)
	{
		for(int coluna =0; coluna<DIM; coluna++)
			{
				if( JdV[0][coluna] == 2 && JdV[1][coluna] ==2 && JdV[2][coluna]==2)
				{
					printf("Parabéns! Segundo jogador ganhou!");
					exit(0);
				}
			}
	}
}

void checardiagonal_principal()
{
	int ct_diagonal;
	if(numero_jogador ==1)
	{
		int linha, coluna;
		ct_diagonal = 0;
		for(linha=0,coluna = 0; linha < DIM; linha++, coluna++ )
		{
			if(JdV[linha][coluna] == 1) ct_diagonal++;
		}
		if(ct_diagonal == DIM) 
		{
			printf("Parabéns! Primeiro jogador ganhou!");
			exit(0);
		}
	}
	if(numero_jogador ==2)
	{
		int linha, coluna;
		ct_diagonal = 0;
		for(linha=0,coluna = 0; linha < DIM; linha++, coluna++ )
		{
			if(JdV[linha][coluna] == 2) ct_diagonal++;
		}
		if(ct_diagonal == DIM) 
		{
			printf("Parabéns! Segundo jogador ganhou!");
			exit(0);
		}
	}
}

void checardiagonal_secundaria()
{
	int ct_diagonal;
	if(numero_jogador ==1)
	{
		int linha, coluna;
		ct_diagonal = 0;
		for(linha=DIM,coluna = DIM; linha >0; --linha, -coluna )
		{
			if(JdV[linha][coluna] == 1) ct_diagonal++;
		}
		if(ct_diagonal == DIM) 
		{
			printf("Parabéns! Primeiro jogador ganhou!");
			exit(0);
		}
	}
	if(numero_jogador ==2)
	{
		int linha, coluna;
		ct_diagonal = 0;
		for(linha=DIM,coluna = DIM; linha >0; --linha, -coluna )
		{
			if(JdV[linha][coluna] == 2) ct_diagonal++;
		}
		if(ct_diagonal == DIM) 
		{
			printf("Parabéns! Segundo jogador ganhou!");
			exit(0);
		}
	}
}

void menu()
{
	int opcao;
	printf("\n------------------Menu------------------");
	printf("\n 1 - Jogar em tabuleiro padrão 3x3");
	printf("\n 2 - Jogar em um tabuleiro especial 5x5");	
	printf("\n 0 - Sair \n");
	printf("\n\nDigite a opção desejada: ");
	scanf("%d",&opcao);
	switch(opcao)
	{
		case 1:
			{
				printf("\nVocê escolheu a opção de jogar em um tabuleiro 3x3!");
				printf("\nAguarde. O jogo começará em instantes.");
				sleep(3);
				DIM = 3;
	 // Colocar o inicializador de matriz aqui						
				system("cls");
				printf("Jogo da Velha!\n");
				rodada(1);
			}
		case 2:
			{
				printf("\nVocê escolheu a opção de jogar em um tabuleiro 5x5!");
				printf("\nAguarde. O jogo começará em instantes.");
				sleep(3);
				DIM = 5;
	 // Colocar o inicializador de matriz aqui			
				system("cls");
				printf("Jogo da Velha!\n");
				rodada(1);
			}
	
		case 0:
			{
				printf("\nQue pena que você já vai embora.");
				sleep(3);
				break;
			}
		default: 
			{
				printf("\nOpção não encontrada! Digite novamente!");
				void menu();
			}
	}
}
